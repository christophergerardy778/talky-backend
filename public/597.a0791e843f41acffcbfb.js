(self.webpackChunktalky=self.webpackChunktalky||[]).push([[597],{4241:(e,t,r)=>{"use strict";r.d(t,{Q:()=>s});var s=(()=>(function(e){e[e.GOOGLE=0]="GOOGLE",e[e.FACEBOOK=1]="FACEBOOK",e[e.TWITTER=2]="TWITTER",e[e.EMAIL=3]="EMAIL"}(s||(s={})),s))()},2597:(e,t,r)=>{"use strict";r.d(t,{e:()=>S});var s=r(6304),i=r(4241),n=r(2704),a=r(7716),o=r(9829),u=r(3637),l=r(7574),d=r(4402),h=r(5917),c=r(9761),p=r(9328),f=r(8002),g=r(2145),y=r(7519),F=r(5435),m=r(6136),w=r(57),U=r(8583),O=r(2329);function v(e,t){return function(e,t=u.z){return new l.y(r=>{let s;return null!=t?t.schedule(()=>{s=e.onSnapshot({includeMetadataChanges:!0},r)}):s=e.onSnapshot({includeMetadataChanges:!0},r),()=>{null!=s&&s()}})}(e,t)}function A(e,t){return v(e,t).pipe((0,f.U)(e=>({payload:e,type:"query"})))}function G(e,t){return A(e,t).pipe((0,c.O)(void 0),(0,p.G)(),(0,f.U)(([e,t])=>{const r=t.payload.docChanges(),s=r.map(e=>({type:e.type,payload:e}));return e&&JSON.stringify(e.payload.metadata)!==JSON.stringify(t.payload.metadata)&&t.payload.docs.forEach((t,i)=>{const n=r.find(e=>e.doc.ref.isEqual(t.ref)),a=null==e?void 0:e.payload.docs.find(e=>e.ref.isEqual(t.ref));n&&JSON.stringify(n.doc.metadata)===JSON.stringify(t.metadata)||!n&&a&&JSON.stringify(a.metadata)===JSON.stringify(t.metadata)||s.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:t}})}),s}))}function I(e,t,r){return G(e,r).pipe((0,g.R)((e,r)=>function(e,t,r){return t.forEach(t=>{r.indexOf(t.type)>-1&&(e=function(e,t){switch(t.type){case"added":if(!e[t.newIndex]||!e[t.newIndex].doc.ref.isEqual(t.doc.ref))return E(e,t.newIndex,0,t);break;case"modified":if(null==e[t.oldIndex]||e[t.oldIndex].doc.ref.isEqual(t.doc.ref)){if(t.oldIndex!==t.newIndex){const r=e.slice();return r.splice(t.oldIndex,1),r.splice(t.newIndex,0,t),r}return E(e,t.newIndex,1,t)}break;case"removed":if(e[t.oldIndex]&&e[t.oldIndex].doc.ref.isEqual(t.doc.ref))return E(e,t.oldIndex,1)}return e}(e,t))}),e}(e,r.map(e=>e.payload),t),[]),(0,y.x)(),(0,f.U)(e=>e.map(e=>({type:e.type,payload:e}))))}function E(e,t,r,...s){const i=e.slice();return i.splice(t,r,...s),i}function L(e){return e&&0!==e.length||(e=["added","removed","modified"]),e}r(5171);class b{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=G(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,f.U)(t=>t.filter(t=>e.indexOf(t.type)>-1)))),t.pipe((0,c.O)(void 0),(0,p.G)(),(0,F.h)(([e,t])=>t.length>0||!e),(0,f.U)(([e,t])=>t),this.afs.keepUnstableUntilFirst)}auditTrail(e){return this.stateChanges(e).pipe((0,g.R)((e,t)=>[...e,...t],[]))}snapshotChanges(e){const t=L(e);return I(this.query,t,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(e={}){return A(this.query,this.afs.schedulers.outsideAngular).pipe((0,f.U)(t=>t.payload.docs.map(t=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data())),this.afs.keepUnstableUntilFirst)}get(e){return(0,d.D)(this.query.get(e)).pipe((0,m.QV)(this.afs.schedulers.insideAngular))}add(e){return this.ref.add(e)}doc(e){return new x(this.ref.doc(e),this.afs)}}class x{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:s,query:i}=B(r,t);return new b(s,i,this.afs)}snapshotChanges(){return v(this.ref,this.afs.schedulers.outsideAngular).pipe((0,c.O)(void 0),(0,p.G)(),(0,f.U)(([e,t])=>t.exists?(null==e?void 0:e.exists)?{payload:t,type:"modified"}:{payload:t,type:"added"}:{payload:t,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(e={}){return this.snapshotChanges().pipe((0,f.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,d.D)(this.ref.get(e)).pipe((0,m.QV)(this.afs.schedulers.insideAngular))}}class C{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?G(this.query,this.afs.schedulers.outsideAngular).pipe((0,f.U)(t=>t.filter(t=>e.indexOf(t.type)>-1)),(0,F.h)(e=>e.length>0),this.afs.keepUnstableUntilFirst):G(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(e){return this.stateChanges(e).pipe((0,g.R)((e,t)=>[...e,...t],[]))}snapshotChanges(e){const t=L(e);return I(this.query,t,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(e={}){return A(this.query,this.afs.schedulers.outsideAngular).pipe((0,f.U)(t=>t.payload.docs.map(t=>e.idField?Object.assign({[e.idField]:t.id},t.data()):t.data())),this.afs.keepUnstableUntilFirst)}get(e){return(0,d.D)(this.query.get(e)).pipe((0,m.QV)(this.afs.schedulers.insideAngular))}}const q=new a.OlP("angularfire2.enableFirestorePersistence"),k=new a.OlP("angularfire2.firestore.persistenceSettings"),P=new a.OlP("angularfire2.firestore.settings"),Q=new a.OlP("angularfire2.firestore.use-emulator");function B(e,t=(e=>e)){return{query:t(e),ref:e}}let T=(()=>{class e{constructor(e,t,r,s,i,n,a,o,u){this.schedulers=new w.HU(n),this.keepUnstableUntilFirst=(0,w.ss)(this.schedulers);const l=(0,w.on)(e,n,t);!O.Z.auth&&u&&(0,w.yq)();const c=o;[this.firestore,this.persistenceEnabled$]=(0,w.sI)(`${l.name}.firestore`,"AngularFirestore",l,()=>{const e=n.runOutsideAngular(()=>l.firestore());if(s&&e.settings(s),c&&e.useEmulator(...c),r&&!(0,U.PM)(i)){const t=()=>{try{return(0,d.D)(e.enablePersistence(a||void 0).then(()=>!0,()=>!1))}catch(t){return"undefined"!=typeof console&&console.warn(t),(0,h.of)(!1)}};return[e,n.runOutsideAngular(t)]}return[e,(0,h.of)(!1)]},[s,c,r])}collection(e,t){let r;r="string"==typeof e?this.firestore.collection(e):e;const{ref:s,query:i}=B(r,t),n=this.schedulers.ngZone.run(()=>s);return new b(n,i,this)}collectionGroup(e,t){const r=t||(e=>e),s=this.firestore.collectionGroup(e);return new C(r(s),this)}doc(e){let t;t="string"==typeof e?this.firestore.doc(e):e;const r=this.schedulers.ngZone.run(()=>t);return new x(r,this)}createId(){return this.firestore.collection("_").doc().id}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(w.Dh),a.LFG(w.xv,8),a.LFG(q,8),a.LFG(P,8),a.LFG(a.Lbi),a.LFG(a.R0b),a.LFG(k,8),a.LFG(Q,8),a.LFG(o.Qv,8))},e.\u0275prov=a.Yz7({factory:function(){return new e(a.LFG(w.Dh),a.LFG(w.xv,8),a.LFG(q,8),a.LFG(P,8),a.LFG(a.Lbi),a.LFG(a.R0b),a.LFG(k,8),a.LFG(Q,8),a.LFG(o.Qv,8))},token:e,providedIn:"any"}),e})(),S=(()=>{class e{constructor(e,t){this.angularFireAuth=e,this.angularFireDataBase=t,this.userCollection=this.angularFireDataBase.collection("users")}registerEmailUser(e){var t=this;return(0,s.Z)(function*(){if(!(yield t.userAlreadyExists(e.email)).empty)throw new Error("User already use");{const r=yield t.angularFireAuth.createUserWithEmailAndPassword(e.email,e.password);yield t.createUserFirestore({id:r.user.uid,name:e.name,email:e.email,registerBy:i.Q.EMAIL,photoUrl:"https://www.uprm.edu/natatorio/wp-content/uploads/sites/142/2018/11/profile-placeholder.png"})}})()}createUserFirestore(e){return this.userCollection.add(e)}userAlreadyExists(e){return this.userCollection.ref.where("email","==",e).get()}getSocialProvider(e){switch(e){case i.Q.GOOGLE:return this.angularFireAuth.signInWithPopup(new n.Z.auth.GoogleAuthProvider);case i.Q.FACEBOOK:return this.angularFireAuth.signInWithPopup(new n.Z.auth.FacebookAuthProvider);default:return this.angularFireAuth.signInWithPopup(new n.Z.auth.TwitterAuthProvider)}}buildUserBySocialProvider(e,t){var r;switch(t){case i.Q.GOOGLE:const{name:t,picture:s}=null===(r=e.additionalUserInfo)||void 0===r?void 0:r.profile;return{id:e.user.uid,name:t,email:e.user.email,registerBy:i.Q.GOOGLE,photoUrl:s};case i.Q.FACEBOOK:return{id:e.user.uid,name:e.additionalUserInfo.profile.name,email:e.user.email,registerBy:i.Q.FACEBOOK,photoUrl:e.user.photoURL};default:return{email:"",id:"",name:"",photoUrl:"",registerBy:i.Q.TWITTER}}}gerUser(){return this.angularFireAuth.user}loginUserByEmailAndPassword(e,t){return this.angularFireAuth.signInWithEmailAndPassword(e,t)}getUserInfoById(e){var t=this;return(0,s.Z)(function*(){return t.userCollection.ref.where("id","==",e).get()})()}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(o.zQ),a.LFG(T))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},6304:(e,t,r)=>{"use strict";function s(e,t,r,s,i,n,a){try{var o=e[n](a),u=o.value}catch(l){return void r(l)}o.done?t(u):Promise.resolve(u).then(s,i)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(i,n){var a=e.apply(t,r);function o(e){s(a,i,n,o,u,"next",e)}function u(e){s(a,i,n,o,u,"throw",e)}o(void 0)})}}r.d(t,{Z:()=>i})}}]);